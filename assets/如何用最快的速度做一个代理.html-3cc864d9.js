import{_ as t}from"./plugin-vue_export-helper-c27b6911.js";import{r,o as l,c as d,a as e,b as a,d as i,e as n}from"./app-5d43e870.js";const o="/assets/cover20230827005-229a7514.jpg",c="/assets/20230827001-7caa63a9.png",h="/assets/20230827002-6020e78f.png",p="/assets/20230827003-bc46b510.png",u="/assets/20230827004-4596d160.png",m={},g=n('<figure><img src="'+o+'" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>目前我使用代理的场景主要有以下两种：</p><ol><li>访问国外的一些网站。</li><li>访问公司内部的一些网站，但是有 ACL 限制。</li></ol><h2 id="原理" tabindex="-1"><a class="header-anchor" href="#原理" aria-hidden="true">#</a> 原理</h2><figure><img src="'+c+'" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>想要访问网络不可达的网站，可以使用一个能访问网站的服务器做代理。</p><h2 id="制作代理" tabindex="-1"><a class="header-anchor" href="#制作代理" aria-hidden="true">#</a> 制作代理</h2><p>制作代理的方式有多种，SSH 动态转发无疑是最快捷的一种。</p><h4 id="ssh-动态转发" tabindex="-1"><a class="header-anchor" href="#ssh-动态转发" aria-hidden="true">#</a> SSH 动态转发</h4>',9),v={href:"https://wangdoc.com/ssh/port-forwarding.html",title:"动态转发",target:"_blank",rel:"noopener noreferrer"},_=n(`<p>动态转发的命令格式：<code>ssh -D &lt;本地端口&gt; &lt;代理主机&gt; -N</code></p><p>其中 <code>-D</code> 表示动态转发，<code>-N</code> 表示只充当隧道，不执行远程命令。</p><p>举例来说，如果本地端口是 2121，代理服务器 ip 为 10.10.10.2(随意写的哈)，那么动态转发的命令就是下面这样。</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>$ ssh -D 2121 10.10.10.2 -N
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h2 id="使用代理" tabindex="-1"><a class="header-anchor" href="#使用代理" aria-hidden="true">#</a> 使用代理</h2><h4 id="终端使用" tabindex="-1"><a class="header-anchor" href="#终端使用" aria-hidden="true">#</a> 终端使用</h4><p>动态转发采用了 SOCKS5 协议。访问外部网站时，需要把 HTTP 请求转成 SOCKS5 协议。</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>$ curl -x socks5://localhost:2121 https://www.google.com
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>也可以设置 http_proxy 环境变量，将 SOCKS5 转换为 HTTP 代理。</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>$ export http_proxy=&quot;socks5://localhost:2121&quot;
$ export https_proxy=$http_proxy
$ curl https://www.google.com
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="浏览器使用" tabindex="-1"><a class="header-anchor" href="#浏览器使用" aria-hidden="true">#</a> 浏览器使用</h4>`,11),b={href:"https://chrome.google.com/webstore/detail/proxy-switchyomega/padekgcemlokbadohgkifijomclgjgif",title:"Proxy SwitchyOmega",target:"_blank",rel:"noopener noreferrer"},x=e("p",null,"Proxy SwitchyOmega 是 Chrome 浏览器的一个插件。安装后可以新建一个 Proxy 情景模式，参考配置如下：",-1),f=e("figure",null,[e("img",{src:h,alt:"",tabindex:"0",loading:"lazy"}),e("figcaption")],-1),y={start:"2"},k={href:"https://github.com/yichengchen/clashX/releases",title:"ClashX",target:"_blank",rel:"noopener noreferrer"},S=n(`<p>ClashX 是一款代理客户端应用，安装后可以修改配置文件增加 sock5 代理，参考配置如下：</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>...略...

# socks5
- name: &quot;socks-wall&quot;
  type: socks5
  server: localhost
  port: 2121

# 代理节点选择
- name: &quot;PROXY&quot;
  type: select
  proxies:
    - &quot;socks-wall&quot;

...略...
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>然后选择对应的 PROXY，设置为系统代理，即可访问。<br><img src="`+p+'" alt="" loading="lazy"></p><p>注意，如果要转发的地址是内网地址，需要注意一下 wifi 设置里面的代理设置，里面针对一些内网地址是不走代理转发的。<br><img src="'+u+`" alt="" loading="lazy"></p><p>如果需要经常使用动态转发，可以将动态转发的命令写入 SSH 客户端的个人配置文件 <code>~/.ssh/config</code></p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>DynamicForward &lt;代理主机&gt;:&lt;本地端口&gt;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>另外，动态转发的命令，默认需要输入当前用户的密码，如果想免密，可以了解一下 <code>ssh-kengen</code>，本文不再详细阐述。</p>`,7);function w(C,q){const s=r("ExternalLinkIcon");return l(),d("div",null,[g,e("p",null,[e("a",v,[a("动态转发"),i(s)]),a("指的是，本机与 SSH 服务器之间创建了一个加密连接，然后本机内部针对某个端口的通信，都通过这个加密连接转发。")]),_,e("ol",null,[e("li",null,[e("a",b,[a("Proxy SwitchyOmega"),i(s)])])]),x,f,e("ol",y,[e("li",null,[e("a",k,[a("ClashX"),i(s)])])]),S])}const N=t(m,[["render",w],["__file","如何用最快的速度做一个代理.html.vue"]]);export{N as default};
